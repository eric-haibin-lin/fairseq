python3 train.py data-bin/wmt14_en_de_joined_dict   --arch transformer_vaswani_wmt_en_de_big --share-all-embeddings   --optimizer adam --adam-betas '(0.9, 0.98)' --clip-norm 0.0   --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --warmup-updates 4000   --lr 0.0005 --min-lr 1e-09   --dropout 0.3 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1   --max-tokens 3584   --fp16 2>&1 | tee train.log

| distributed init (rank 4): tcp://localhost:10005
| distributed init (rank 3): tcp://localhost:10005
| distributed init (rank 1): tcp://localhost:10005
| distributed init (rank 0): tcp://localhost:10005
| distributed init (rank 2): tcp://localhost:10005
| distributed init (rank 5): tcp://localhost:10005
| distributed init (rank 7): tcp://localhost:10005
| distributed init (rank 6): tcp://localhost:10005
Namespace(adam_betas='(0.9, 0.98)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, arch='transformer_vaswani_wmt_en_de_big', attention_dropout=0.0, bucket_cap_mb=150, clip_norm=0.0, criterion='label_smoothed_cross_entropy', data=['data-bin/wmt14_en_de_joined_dict'], ddp_backend='no_c10d', decoder_attention_heads=16, decoder_embed_dim=1024, decoder_embed_path=None, decoder_ffn_embed_dim=4096, decoder_input_dim=1024, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=False, decoder_output_dim=1024, device_id=0, distributed_backend='nccl', distributed_init_host='localhost', distributed_init_method='tcp://localhost:10005', distributed_port=10006, distributed_rank=0, distributed_world_size=8, dropout=0.3, encoder_attention_heads=16, encoder_embed_dim=1024, encoder_embed_path=None, encoder_ffn_embed_dim=4096, encoder_layers=6, encoder_learned_pos=False, encoder_normalize_before=False, fix_batches_to_gpus=False, fp16=True, fp16_init_scale=128, keep_interval_updates=-1, label_smoothing=0.1, left_pad_source='True', left_pad_target='False', log_format=None, log_interval=1000, lr=[0.0005], lr_scheduler='inverse_sqrt', lr_shrink=0.1, max_epoch=0, max_sentences=None, max_sentences_valid=None, max_source_positions=1024, max_target_positions=1024, max_tokens=3584, max_update=0, min_loss_scale=0.0001, min_lr=1e-09, momentum=0.99, no_epoch_checkpoints=False, no_progress_bar=False, no_save=False, no_token_positional_embeddings=False, optimizer='adam', optimizer_overrides='{}', raw_text=False, relu_dropout=0.0, reset_lr_scheduler=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='checkpoints', save_interval=1, save_interval_updates=0, seed=1, sentence_avg=False, share_all_embeddings=True, share_decoder_input_output_embed=False, skip_invalid_size_inputs_valid_test=False, source_lang=None, target_lang=None, task='translation', train_subset='train', update_freq=[1], upsample_primary=1, valid_subset='valid', validate_interval=1, warmup_init_lr=1e-07, warmup_updates=4000, weight_decay=0.0)
| [en] dictionary: 32768 types
| [de] dictionary: 32768 types
| data-bin/wmt14_en_de_joined_dict train 4528446 examples
| data-bin/wmt14_en_de_joined_dict valid 3000 examples
| model transformer_vaswani_wmt_en_de_big, criterion LabelSmoothedCrossEntropyCriterion
| num. model params: 209911808
| training on 8 GPUs
| max tokens per GPU = 3584 and max sentences per GPU = None
| WARNING: overflow detected, setting loss scale to: 64.0
| WARNING: overflow detected, setting loss scale to: 32.0
| WARNING: overflow detected, setting loss scale to: 16.0
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 001:   1000 / 5492 loss=10.917, nll_loss=10.255, ppl=1221.79, wps=6254, ups=0.2, wpb=25113, bsz=830, num_updates=997, lr=0.0001247, gnorm=1.416, clip=0%, oom=0, loss_scale=8.000, wall=4003, train_wall=3949
| epoch 001:   2000 / 5492 loss=9.800, nll_loss=8.950, ppl=494.48, wps=6355, ups=0.3, wpb=25096, bsz=823, num_updates=1997, lr=0.000249675, gnorm=1.194, clip=0%, oom=0, loss_scale=8.000, wall=7886, train_wall=7811
| epoch 001:   3000 / 5492 loss=9.017, nll_loss=8.039, ppl=263.09, wps=6365, ups=0.3, wpb=25101, bsz=824, num_updates=2997, lr=0.00037465, gnorm=1.094, clip=0%, oom=0, loss_scale=16.000, wall=11818, train_wall=11723
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 001:   4000 / 5492 loss=8.309, nll_loss=7.220, ppl=149.06, wps=6379, ups=0.3, wpb=25118, bsz=824, num_updates=3996, lr=0.0004995, gnorm=1.023, clip=0%, oom=0, loss_scale=8.000, wall=15735, train_wall=15620
| epoch 001:   5000 / 5492 loss=7.772, nll_loss=6.603, ppl=97.21, wps=6387, ups=0.3, wpb=25125, bsz=824, num_updates=4996, lr=0.000447393, gnorm=0.947, clip=0%, oom=0, loss_scale=8.000, wall=19654, train_wall=19518
| epoch 001 | loss 7.557 | nll_loss 6.357 | ppl 81.98 | wps 6394 | ups 0.3 | wpb 25123 | bsz 824 | num_updates 5487 | lr 0.000426906 | gnorm 0.914 | clip 0% | oom 0 | loss_scale 8.000 | wall 21559 | train_wall 21414
| epoch 001 | valid on 'valid' subset | valid_loss 4.96759 | valid_nll_loss 3.24457 | valid_ppl 9.48 | num_updates 5487
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 002:   1000 / 5492 loss=5.252, nll_loss=3.729, ppl=13.26, wps=6363, ups=0.3, wpb=25164, bsz=825, num_updates=6487, lr=0.000392625, gnorm=0.541, clip=0%, oom=0, loss_scale=8.000, wall=25528, train_wall=25347
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 002:   2000 / 5492 loss=5.175, nll_loss=3.645, ppl=12.51, wps=6376, ups=0.3, wpb=25163, bsz=823, num_updates=7485, lr=0.000365514, gnorm=0.526, clip=0%, oom=0, loss_scale=2.000, wall=29459, train_wall=29258
| epoch 002:   3000 / 5492 loss=5.117, nll_loss=3.581, ppl=11.97, wps=6397, ups=0.3, wpb=25121, bsz=822, num_updates=8485, lr=0.0003433, gnorm=0.516, clip=0%, oom=0, loss_scale=2.000, wall=33347, train_wall=33126
| epoch 002:   4000 / 5492 loss=5.067, nll_loss=3.527, ppl=11.53, wps=6367, ups=0.3, wpb=25129, bsz=825, num_updates=9485, lr=0.000324699, gnorm=0.509, clip=0%, oom=0, loss_scale=4.000, wall=37352, train_wall=37111
| epoch 002:   5000 / 5492 loss=5.027, nll_loss=3.483, ppl=11.18, wps=6374, ups=0.3, wpb=25138, bsz=825, num_updates=10485, lr=0.000308827, gnorm=0.501, clip=0%, oom=0, loss_scale=4.000, wall=41287, train_wall=41025
| epoch 002 | loss 5.012 | nll_loss 3.467 | ppl 11.06 | wps 6380 | ups 0.3 | wpb 25123 | bsz 824 | num_updates 10976 | lr 0.000301841 | gnorm 0.499 | clip 0% | oom 0 | loss_scale 8.000 | wall 43188 | train_wall 42916
| epoch 002 | valid on 'valid' subset | valid_loss 4.43252 | valid_nll_loss 2.68943 | valid_ppl 6.45 | num_updates 10976 | best 4.43252
| epoch 003:   1000 / 5492 loss=4.773, nll_loss=3.205, ppl=9.22, wps=6421, ups=0.3, wpb=25173, bsz=823, num_updates=11977, lr=0.000288952, gnorm=0.461, clip=0%, oom=0, loss_scale=8.000, wall=47159, train_wall=46818
| epoch 003:   2000 / 5492 loss=4.751, nll_loss=3.181, ppl=9.07, wps=6419, ups=0.3, wpb=25146, bsz=824, num_updates=12977, lr=0.000277596, gnorm=0.455, clip=0%, oom=0, loss_scale=16.000, wall=51074, train_wall=50713
| epoch 003:   3000 / 5492 loss=4.739, nll_loss=3.169, ppl=9.00, wps=6410, ups=0.3, wpb=25129, bsz=824, num_updates=13977, lr=0.000267481, gnorm=0.451, clip=0%, oom=0, loss_scale=16.000, wall=55001, train_wall=54619
| epoch 003:   4000 / 5492 loss=4.724, nll_loss=3.153, ppl=8.90, wps=6391, ups=0.3, wpb=25130, bsz=825, num_updates=14977, lr=0.000258397, gnorm=0.448, clip=0%, oom=0, loss_scale=32.000, wall=58966, train_wall=58565
| WARNING: overflow detected, setting loss scale to: 16.0
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 003:   5000 / 5492 loss=4.712, nll_loss=3.141, ppl=8.82, wps=6381, ups=0.3, wpb=25124, bsz=826, num_updates=15975, lr=0.000250196, gnorm=0.445, clip=0%, oom=0, loss_scale=8.000, wall=62919, train_wall=62498
| epoch 003 | loss 4.707 | nll_loss 3.135 | ppl 8.78 | wps 6393 | ups 0.3 | wpb 25124 | bsz 824 | num_updates 16466 | lr 0.000246437 | gnorm 0.443 | clip 0% | oom 0 | loss_scale 8.000 | wall 64811 | train_wall 64380
| epoch 003 | valid on 'valid' subset | valid_loss 4.25167 | valid_nll_loss 2.49833 | valid_ppl 5.65 | num_updates 16466 | best 4.25167
| epoch 004:   1000 / 5492 loss=4.586, nll_loss=3.002, ppl=8.01, wps=6390, ups=0.3, wpb=25112, bsz=828, num_updates=17467, lr=0.000239271, gnorm=0.424, clip=0%, oom=0, loss_scale=16.000, wall=68792, train_wall=68292
| epoch 004:   2000 / 5492 loss=4.585, nll_loss=3.001, ppl=8.00, wps=6352, ups=0.3, wpb=25109, bsz=826, num_updates=18467, lr=0.000232703, gnorm=0.423, clip=0%, oom=0, loss_scale=16.000, wall=72768, train_wall=72247
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 004:   3000 / 5492 loss=4.578, nll_loss=2.993, ppl=7.96, wps=6366, ups=0.3, wpb=25104, bsz=824, num_updates=19466, lr=0.000226653, gnorm=0.422, clip=0%, oom=0, loss_scale=8.000, wall=76689, train_wall=76149
| epoch 004:   4000 / 5492 loss=4.572, nll_loss=2.987, ppl=7.93, wps=6364, ups=0.3, wpb=25115, bsz=824, num_updates=20466, lr=0.000221046, gnorm=0.421, clip=0%, oom=0, loss_scale=8.000, wall=80643, train_wall=80082
| epoch 004:   5000 / 5492 loss=4.568, nll_loss=2.983, ppl=7.91, wps=6387, ups=0.3, wpb=25128, bsz=824, num_updates=21466, lr=0.000215836, gnorm=0.419, clip=0%, oom=0, loss_scale=16.000, wall=84529, train_wall=83948
| epoch 004 | loss 4.566 | nll_loss 2.981 | ppl 7.90 | wps 6372 | ups 0.3 | wpb 25123 | bsz 824 | num_updates 21957 | lr 0.000213409 | gnorm 0.419 | clip 0% | oom 0 | loss_scale 16.000 | wall 86509 | train_wall 85918
| epoch 004 | valid on 'valid' subset | valid_loss 4.14782 | valid_nll_loss 2.39646 | valid_ppl 5.27 | num_updates 21957 | best 4.14782
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 005:   1000 / 5492 loss=4.486, nll_loss=2.892, ppl=7.42, wps=6269, ups=0.2, wpb=25131, bsz=833, num_updates=22957, lr=0.00020871, gnorm=0.405, clip=0%, oom=0, loss_scale=8.000, wall=90564, train_wall=89904
| epoch 005:   2000 / 5492 loss=4.493, nll_loss=2.900, ppl=7.47, wps=6311, ups=0.2, wpb=25102, bsz=828, num_updates=23957, lr=0.000204307, gnorm=0.407, clip=0%, oom=0, loss_scale=8.000, wall=94510, train_wall=93829
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 005:   3000 / 5492 loss=4.488, nll_loss=2.895, ppl=7.44, wps=6341, ups=0.3, wpb=25111, bsz=826, num_updates=24956, lr=0.000200176, gnorm=0.407, clip=0%, oom=0, loss_scale=8.000, wall=98433, train_wall=97732
| epoch 005:   4000 / 5492 loss=4.483, nll_loss=2.889, ppl=7.41, wps=6364, ups=0.3, wpb=25123, bsz=826, num_updates=25956, lr=0.000196282, gnorm=0.406, clip=0%, oom=0, loss_scale=8.000, wall=102342, train_wall=101621
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 005:   5000 / 5492 loss=4.479, nll_loss=2.885, ppl=7.39, wps=6373, ups=0.3, wpb=25131, bsz=825, num_updates=26955, lr=0.000192611, gnorm=0.406, clip=0%, oom=0, loss_scale=4.000, wall=106263, train_wall=105522
| epoch 005 | loss 4.477 | nll_loss 2.884 | ppl 7.38 | wps 6392 | ups 0.3 | wpb 25124 | bsz 824 | num_updates 27446 | lr 0.00019088 | gnorm 0.406 | clip 0% | oom 0 | loss_scale 4.000 | wall 108132 | train_wall 107381
| epoch 005 | valid on 'valid' subset | valid_loss 4.09439 | valid_nll_loss 2.34088 | valid_ppl 5.07 | num_updates 27446 | best 4.09439
| epoch 006:   1000 / 5492 loss=4.417, nll_loss=2.816, ppl=7.04, wps=6497, ups=0.3, wpb=25109, bsz=822, num_updates=28447, lr=0.000187492, gnorm=0.402, clip=0%, oom=0, loss_scale=4.000, wall=112046, train_wall=111226
| epoch 006:   2000 / 5492 loss=4.419, nll_loss=2.819, ppl=7.06, wps=6466, ups=0.3, wpb=25122, bsz=819, num_updates=29447, lr=0.000184281, gnorm=0.401, clip=0%, oom=0, loss_scale=8.000, wall=115952, train_wall=115112
| epoch 006:   3000 / 5492 loss=4.414, nll_loss=2.813, ppl=7.03, wps=6401, ups=0.3, wpb=25121, bsz=824, num_updates=30447, lr=0.000181229, gnorm=0.402, clip=0%, oom=0, loss_scale=8.000, wall=119955, train_wall=119095
| epoch 006:   4000 / 5492 loss=4.417, nll_loss=2.817, ppl=7.05, wps=6413, ups=0.3, wpb=25133, bsz=824, num_updates=31447, lr=0.000178324, gnorm=0.401, clip=0%, oom=0, loss_scale=16.000, wall=123858, train_wall=122977
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 006:   5000 / 5492 loss=4.418, nll_loss=2.818, ppl=7.05, wps=6400, ups=0.3, wpb=25125, bsz=823, num_updates=32446, lr=0.000175558, gnorm=0.401, clip=0%, oom=0, loss_scale=8.000, wall=127805, train_wall=126904
| epoch 006 | loss 4.415 | nll_loss 2.815 | ppl 7.04 | wps 6390 | ups 0.3 | wpb 25123 | bsz 824 | num_updates 32937 | lr 0.000174244 | gnorm 0.401 | clip 0% | oom 0 | loss_scale 8.000 | wall 129767 | train_wall 128856
| epoch 006 | valid on 'valid' subset | valid_loss 4.05716 | valid_nll_loss 2.30264 | valid_ppl 4.93 | num_updates 32937 | best 4.05716
| epoch 007:   1000 / 5492 loss=4.370, nll_loss=2.765, ppl=6.80, wps=6485, ups=0.3, wpb=25113, bsz=816, num_updates=33938, lr=0.000171655, gnorm=0.399, clip=0%, oom=0, loss_scale=16.000, wall=133691, train_wall=132711
| epoch 007:   2000 / 5492 loss=4.370, nll_loss=2.765, ppl=6.80, wps=6470, ups=0.3, wpb=25126, bsz=819, num_updates=34938, lr=0.000169181, gnorm=0.398, clip=0%, oom=0, loss_scale=16.000, wall=137584, train_wall=136584
| WARNING: overflow detected, setting loss scale to: 8.0
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 007:   3000 / 5492 loss=4.372, nll_loss=2.767, ppl=6.81, wps=6428, ups=0.3, wpb=25129, bsz=820, num_updates=35936, lr=0.000166815, gnorm=0.398, clip=0%, oom=0, loss_scale=4.000, wall=141538, train_wall=140518
| epoch 007:   4000 / 5492 loss=4.368, nll_loss=2.763, ppl=6.79, wps=6403, ups=0.3, wpb=25132, bsz=823, num_updates=36936, lr=0.000164541, gnorm=0.399, clip=0%, oom=0, loss_scale=4.000, wall=145510, train_wall=144469
| epoch 007:   5000 / 5492 loss=4.366, nll_loss=2.761, ppl=6.78, wps=6393, ups=0.3, wpb=25137, bsz=824, num_updates=37936, lr=0.000162358, gnorm=0.399, clip=0%, oom=0, loss_scale=4.000, wall=149469, train_wall=148408
| epoch 007 | loss 4.366 | nll_loss 2.762 | ppl 6.78 | wps 6386 | ups 0.3 | wpb 25123 | bsz 824 | num_updates 38427 | lr 0.000161318 | gnorm 0.399 | clip 0% | oom 0 | loss_scale 8.000 | wall 151412 | train_wall 150341
| epoch 007 | valid on 'valid' subset | valid_loss 4.02682 | valid_nll_loss 2.2683 | valid_ppl 4.82 | num_updates 38427 | best 4.02682
| epoch 008:   1000 / 5492 loss=4.322, nll_loss=2.712, ppl=6.55, wps=6434, ups=0.3, wpb=25086, bsz=815, num_updates=39428, lr=0.000159257, gnorm=0.396, clip=0%, oom=0, loss_scale=8.000, wall=155363, train_wall=154223
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 008:   2000 / 5492 loss=4.320, nll_loss=2.710, ppl=6.54, wps=6418, ups=0.3, wpb=25126, bsz=823, num_updates=40427, lr=0.000157277, gnorm=0.397, clip=0%, oom=0, loss_scale=4.000, wall=159290, train_wall=158130
| epoch 008:   3000 / 5492 loss=4.324, nll_loss=2.714, ppl=6.56, wps=6396, ups=0.3, wpb=25137, bsz=825, num_updates=41427, lr=0.000155367, gnorm=0.398, clip=0%, oom=0, loss_scale=4.000, wall=163251, train_wall=162071
| epoch 008:   4000 / 5492 loss=4.323, nll_loss=2.714, ppl=6.56, wps=6386, ups=0.3, wpb=25125, bsz=824, num_updates=42427, lr=0.000153525, gnorm=0.397, clip=0%, oom=0, loss_scale=8.000, wall=167198, train_wall=165998
| epoch 008:   5000 / 5492 loss=4.327, nll_loss=2.718, ppl=6.58, wps=6391, ups=0.3, wpb=25124, bsz=824, num_updates=43427, lr=0.000151747, gnorm=0.397, clip=0%, oom=0, loss_scale=8.000, wall=171116, train_wall=169895
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 008 | loss 4.328 | nll_loss 2.720 | ppl 6.59 | wps 6388 | ups 0.3 | wpb 25123 | bsz 824 | num_updates 43917 | lr 0.000150898 | gnorm 0.397 | clip 0% | oom 0 | loss_scale 8.000 | wall 173053 | train_wall 171822
| epoch 008 | valid on 'valid' subset | valid_loss 4.00186 | valid_nll_loss 2.24655 | valid_ppl 4.75 | num_updates 43917 | best 4.00186
| epoch 009:   1000 / 5492 loss=4.279, nll_loss=2.664, ppl=6.34, wps=6306, ups=0.2, wpb=25102, bsz=830, num_updates=44918, lr=0.000149207, gnorm=0.398, clip=0%, oom=0, loss_scale=8.000, wall=177089, train_wall=175789
| epoch 009:   2000 / 5492 loss=4.291, nll_loss=2.678, ppl=6.40, wps=6364, ups=0.3, wpb=25117, bsz=828, num_updates=45918, lr=0.000147574, gnorm=0.398, clip=0%, oom=0, loss_scale=16.000, wall=181001, train_wall=179681
